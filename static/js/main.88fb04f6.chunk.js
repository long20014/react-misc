(this["webpackJsonpcard-app"]=this["webpackJsonpcard-app"]||[]).push([[0],{32:function(e,t,n){e.exports=n(59)},37:function(e,t,n){},38:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},48:function(e,t,n){},49:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(19),o=n.n(r),c=(n(37),n(1)),l=n(2),s=n(4),u=n(3),m=n(5),p=(n(38),n(14)),d=Object.freeze({IS_LOGGED_IN:"isLoggedIn"}),h=function(){return"true"===localStorage.getItem(d.IS_LOGGED_IN)},g=function(e,t,n){e.meta.AUTH_ONLY&&!h()&&n.redirect("/login"),n()},f=n(21),v=n(11),b=Object(v.a)(),y=n(8),E=n(12),O=(n(44),n(7)),j=n(9),S=n.n(j);var k=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).logout=n.logout.bind(Object(E.a)(n)),n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"logout",value:function(){this.props.logoutAction(),b.push("/login")}},{key:"render",value:function(){var e=this.props.isLoggedIn;return i.a.createElement("div",{className:"component-wrapper"},i.a.createElement("div",{className:"nav"},i.a.createElement("h3",null,"Logo"),i.a.createElement("ul",{className:"nav-links"},i.a.createElement("li",null,i.a.createElement(O.a,{to:"/"},"Home")),i.a.createElement("li",null,i.a.createElement(O.a,{to:"/clock"},"Clock")),i.a.createElement("li",null,i.a.createElement(O.a,{to:"/puzzle"},"Puzzle"))),e&&i.a.createElement("button",{onClick:this.logout,style:{color:"black"}},"Log out")))}}]),t}(i.a.Component);k.propsType={logoutAction:S.a.func.isRequired};var z=Object(p.b)((function(e){return{isLoggedIn:e.auth.isLoggedIn}}),{logoutAction:function(){return function(e){localStorage.removeItem(d.IS_LOGGED_IN),e({type:"logout",isLoggedIn:h()})}}})(k),N=(n(45),n(46),n(47),function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{id:"piece-".concat(this.props.id),className:"puzzle-piece",draggable:this.props.draggable},i.a.createElement("h1",null,this.props.id))}}]),t}(i.a.Component)),I=(n(48),function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"createPuzzlePiece",value:function(){var e=this.props.pieceId;if(null!==e)return i.a.createElement(N,{key:e,id:e,draggable:!1})}},{key:"render",value:function(){return i.a.createElement("div",{id:"slot-".concat(this.props.id),className:"puzzle-grid__slot"},this.createPuzzlePiece())}}]),t}(i.a.Component)),w=(n(49),function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e)))._isMounted=!1,n._isStopped=!1,n.subscribeStop=function(){n.props.updateStop((function(e){e&&!n._isStopped&&(n.stopTimer(),n._isStopped=!0,n.props.emitTime(n.state.time))}))},n.state={time:0,isOn:!1,start:0},n.startTimer=n.startTimer.bind(Object(E.a)(n)),n.stopTimer=n.stopTimer.bind(Object(E.a)(n)),n.resetTimer=n.resetTimer.bind(Object(E.a)(n)),n.upTimingFunc=n.upTimingFunc.bind(Object(E.a)(n)),n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,this.stopTimer()}},{key:"componentDidMount",value:function(){this._isMounted=!0,this._isMounted&&this.startTimer()}},{key:"componentDidUpdate",value:function(e){this.props.stop!==e.stop&&!0===this.props.stop&&this.stopTimer()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setState((function(t){return t.isOn=!e.stop}))}},{key:"startTimer",value:function(){var e=this;this.setState({isOn:!0,time:this.state.time,start:Date.now()-this.state.time}),this.timer=setInterval((function(){return e.setState({time:Date.now()-e.state.start})}),10)}},{key:"stopTimer",value:function(){this.setState({isOn:!1}),clearInterval(this.timer)}},{key:"resetTimer",value:function(){this.setState({time:0,isOn:!1})}},{key:"upTimingFunc",value:function(){this.startTimer()}},{key:"downTimingFunc",value:function(e){}},{key:"render",value:function(){var e=this;if(this._isStopped||setTimeout((function(){return e.subscribeStop()}),0),this.props.upTimer)return i.a.createElement("div",{className:"component-wrapper"});0===this.state.time&&i.a.createElement("button",{onClick:this.startTimer},"start"),0!==this.state.time&&this.state.isOn&&i.a.createElement("button",{onClick:this.stopTimer},"stop"),0===this.state.time||this.state.isOn||i.a.createElement("button",{onClick:this.startTimer},"resume"),0===this.state.time||this.state.isOn||i.a.createElement("button",{onClick:this.resetTimer},"reset");return i.a.createElement("div",{className:"component-wrapper ".concat(this.props.className)},i.a.createElement("h3",null,"timer: ",Math.floor(this.state.time/10)/100," s"))}}]),t}(i.a.Component)),T={height:3,width:3};n(50);var L=function(e){return e.id.split("-")[1]},_=function(e){var t=[];return e.forEach((function(e){var n=L(e);t.push(n)})),t},C=function(e,t){for(var n=[],a=0;a<e-t;a++)n.push(a);return n},W=function(e){var t=Math.floor(100*Math.random()%e.length);return e.splice(t,1)[0]},M=function(e){var t=[];return e.forEach((function(e){e.hasChildNodes()||t.push(e)})),t},A=function(e,t){e.forEach((function(e){return e.style.backgroundColor=t}))},D=function(e,t,n){var a=[],i=_(t);return e.forEach((function(e){var t=L(e),r=!1;i.forEach((function(a){if(!i.includes(t)&&!r){var o=e.firstElementChild.draggable;G(t,a,n)&&!o?(e.firstElementChild.draggable=!0,r=!0):e.firstElementChild.draggable=!1}})),a.push(e)})),a},G=function(e,t,n){return(e=+e)===(t=+t)+1&&Math.floor(e/n)===Math.floor(t/n)||e===t-1&&Math.floor(e/n)===Math.floor(t/n)||e===t+n||e===t-n},U=function(){return{getPieceIdSet:C,getRandomPieceId:W,getIdNumber:L,getIdNumbers:_,findEmptySlots:M,coloringEmptySlots:A,transformSlots:D,isAdjacent:G}}(),x=function(e){var t=160,n=160;return(e.width>3||e.height>3)&&(t=120,n=120),{width:t,height:n}},R={width:"".concat(T.width*x(T).width+30,"px"),height:"".concat(T.height*x(T).height+30,"px"),gridTemplateColumns:"repeat(".concat(T.width,", ").concat(x(T).width,"px)"),gridTemplateRows:"repeat(".concat(T.height,", ").concat(x(T).height,"px)"),gridGap:"10px",border:"1px solid wheat"},P=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).emptySlotBg="rgba(255, 255, 255, 0.3)",n._isMounted=!1,n.isWin=!1,n.subscribeWinning=function(e){n.isWin=n.props.isWin,e(n.isWin)},n.getEmittedTime=function(e){console.log("get time");var t={playedTime:e,playerName:"Unknown player",level:n.props.gameLevel.level};n.props.getWinningInfo(t)},n.announceWinning=n.announceWinning.bind(Object(E.a)(n)),n.gameSettings={emptySlotQuantity:e.gameLevel.emptySlotQuantity,arraySize:e.gameLevel.arraySize},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return!!e.isUpdated}},{key:"componentDidMount",value:function(){this.initDraggingEnvironment()}},{key:"componentWillUnmount",value:function(){this.props.restartGame()}},{key:"getEmptySlotIds",value:function(e,t){for(var n=[],a=0;a<t;){var i=Math.floor(100*Math.random()%e);n.includes(i)||(n.push(i),a++)}return n}},{key:"createGridSlots",value:function(e){for(var t=[],n=T.height*T.width,a=this.getEmptySlotIds(n,e),r=U.getPieceIdSet(n,e),o=0;o<n;o++){var c=null;a.includes(o)||(c=U.getRandomPieceId(r)),t.push(i.a.createElement(I,{id:o,key:o,pieceId:c}))}return t}},{key:"initDraggingEnvironment",value:function(){var e=this,t=Array.from(document.querySelectorAll(".puzzle-grid__slot")),n=U.findEmptySlots(t),a=U.transformSlots(t,n,this.gameSettings.arraySize),i=Array.from(document.querySelectorAll(".puzzle-piece"));U.coloringEmptySlots(n,this.emptySlotBg);var r=null,o=null;i.forEach((function(i){i.addEventListener("dragstart",(function(){o=i.parentElement,r=i,setTimeout((function(){i.style.display="none"}))})),i.addEventListener("dragend",(function(){setTimeout((function(){r.style.display="flex",r=null}))})),t.forEach((function(i){i.addEventListener("dragover",(function(e){e.preventDefault()})),i.addEventListener("dragenter",(function(e){e.preventDefault(),o.id===i.id||i.hasChildNodes()||(i.style.backgroundColor="rgba(255, 255, 255, 0.6)")})),i.addEventListener("dragleave",(function(t){t.preventDefault();var a=U.getIdNumbers(n),r=U.getIdNumber(i);a.includes(r)?i.style.backgroundColor=e.emptySlotBg:i.style.backgroundColor="rgba(255, 255, 255, 1)"})),i.addEventListener("drop",(function(o){var c=r.parentNode,l=U.getIdNumber(i),s=U.getIdNumber(c);console.log(c),!i.hasChildNodes()&&U.isAdjacent(l,s,e.gameSettings.arraySize)?(i.append(r),i.style.backgroundColor="rgba(255, 255, 255, 1)",t=Array.from(document.querySelectorAll(".puzzle-grid__slot")),n=U.findEmptySlots(t),U.coloringEmptySlots(n,e.emptySlotBg),a=U.transformSlots(t,n,e.gameSettings.arraySize),setTimeout((function(){return e.checkWiningCondition(a,n)}),100)):l!==s&&(i.style.backgroundColor=e.emptySlotBg)}))}))}))}},{key:"checkWiningCondition",value:function(e,t){var n=0,a=e.length-t.length;e.forEach((function(e){var t=e.firstElementChild,a=U.getIdNumber(e),i=null;t&&(i=U.getIdNumber(t)),a===i&&n++})),n===a&&this.announceWinning()}},{key:"announceWinning",value:function(){var e=this;this.props.broadcastWinning(),setTimeout((function(){console.log("You win the game",e.props.isWin),alert("Congratulation! You win the game")}),100)}},{key:"render",value:function(){var e=this.createGridSlots(this.gameSettings.emptySlotQuantity);return i.a.createElement("div",{className:"component-wrapper puzzle-wrapper"},i.a.createElement("div",{className:"puzzle-grid",style:R},e.map((function(e){return e}))),i.a.createElement(w,{className:"timer-pos",stop:this.isWin,updateStop:this.subscribeWinning,emitTime:this.getEmittedTime}),i.a.createElement("button",{onClick:this.announceWinning},"Win"))}}]),t}(i.a.Component);P.propsType={broadcastWinning:S.a.func.isRequired,restartGame:S.a.func.isRequired,getWinningInfo:S.a.func.isRequired};var B=Object(p.b)((function(e){return{isUpdated:!1,isWin:e.puzzle.isWin,gameLevel:e.puzzle.gameLevel}}),{broadcastWinning:function(){return function(e){e({type:"broadcastWinning",isWin:!0})}},restartGame:function(){return function(e){e({type:"broadcastWinning",isWin:!1})}},getWinningInfo:function(e){return function(t){t({type:"getWinningInfo",winningInfo:e})}}})(P),q=(n(52),function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"component-wrapper"},i.a.createElement("ul",{className:"puzzle-menu"},i.a.createElement("li",null,i.a.createElement(O.a,{to:"/puzzle/game"},"Start Game")),i.a.createElement("li",null,i.a.createElement(O.a,{to:"/puzzle/score-board"},"Score Board")),i.a.createElement("li",null,i.a.createElement(O.a,{to:"/puzzle/setting"},"Setting"))))}}]),t}(i.a.Component)),H=(n(53),function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).change=function(e){n.props.changeGameLevel(e.target.value)},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"component-wrapper"},i.a.createElement("ul",{className:"puzzle-setting"},i.a.createElement("div",{className:"setting-option-wrapper"},i.a.createElement("label",{htmlFor:"level",style:{marginRight:"10px"}},"Game Level:"),i.a.createElement("select",{name:"level",id:"level",onChange:this.change,value:this.props.level},i.a.createElement("option",{value:"Easy"},"Easy"),i.a.createElement("option",{value:"Normal"},"Normal"),i.a.createElement("option",{value:"Hard"},"Hard"))),i.a.createElement("li",null,i.a.createElement(O.a,{to:"/puzzle"},"Back"))))}}]),t}(i.a.Component));H.propsType={changeGameLevel:S.a.func.isRequired};var Q=Object(p.b)((function(e){return{isUpdated:!1,level:e.puzzle.gameLevel.level}}),{changeGameLevel:function(e){return function(t){t({type:"changeGameLevel",level:e})}}})(H),F=(n(54),function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"component-wrapper"},i.a.createElement("ul",{className:"puzzle-menu"},this.props.winningInfo.map((function(t){var n=e.props.winningInfo.indexOf(t);return i.a.createElement("p",{key:n},n+1,". ",t.playerName,": ",+t.playedTime/1e3,"s (",t.level,")")})),i.a.createElement("li",null,i.a.createElement(O.a,{to:"/puzzle"},"Back"))))}}]),t}(i.a.Component)),X=Object(p.b)((function(e){return{isUpdated:!1,winningInfo:e.puzzle.winningInfo}}),{})(F),Y=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"component-wrapper"},i.a.createElement("div",{className:"App"},i.a.createElement("header",{className:"App-header"},i.a.createElement(y.d,null,i.a.createElement(y.b,{path:"/puzzle",exact:!0,component:q}),i.a.createElement(y.b,{path:"/puzzle/game",exact:!0,component:B}),i.a.createElement(y.b,{path:"/puzzle/setting",exact:!0,component:Q}),i.a.createElement(y.b,{path:"/puzzle/score-board",exact:!0,component:X})))))}}]),t}(i.a.Component),J=function(){return i.a.createElement(y.b,{path:"/puzzle",component:Y})},V=(n(55),function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"component-wrapper"},i.a.createElement("h1",null,"HomePage"))}}]),t}(i.a.Component)),$=function(){return i.a.createElement(f.b,{path:"/",exact:!0,component:V,meta:{AUTH_ONLY:!0}})},K=(n(56),n(57),function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.hour,t=this.props.minute,n=this.props.second;return i.a.createElement("div",{className:"component-wrapper"},i.a.createElement("div",{className:"clock-wrapper"},i.a.createElement("div",{className:"clock"},i.a.createElement("div",{className:"hand hour-hand",style:{transform:"rotate(".concat(30*e+t/2+n/120-90,"deg)")}}),i.a.createElement("div",{className:"hand minute-hand",style:{transform:"rotate(".concat(6*t+n/10-90,"deg)")}}),i.a.createElement("div",{className:"hand second-hand",style:{transform:"rotate(".concat(6*n-90,"deg)")}}))),i.a.createElement("div",{className:"timer"},e,":",t<10?"0"+t:t,":",n<10?"0"+n:n))}}]),t}(i.a.Component)),Z=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this)))._isMounted=!1,e.state={time:new Date},e}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,this._isMounted&&(this.clock=setInterval((function(){e.setState((function(e){return e.time=new Date}))}),1e3))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,clearInterval(this.clock)}},{key:"render",value:function(){var e=this.state.time.getHours(),t=this.state.time.getMinutes(),n=this.state.time.getSeconds();return i.a.createElement("div",{className:"App"},i.a.createElement("header",{className:"App-header"},i.a.createElement(K,{hour:e,minute:t,second:n})))}}]),t}(i.a.Component),ee=function(){return i.a.createElement(y.b,{path:"/clock",component:Z})},te=(n(58),function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).login=n.login.bind(Object(E.a)(n)),n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"login",value:function(){this.props.loginAction(),b.push("/")}},{key:"render",value:function(){return this.props.isLoggedIn?i.a.createElement(y.a,{to:"/"}):i.a.createElement("div",{className:"component-wrapper"},i.a.createElement("button",{onClick:this.login},"Log in"))}}]),t}(i.a.Component)),ne=Object(p.b)((function(e){return{isLoggedIn:e.auth.isLoggedIn}}),{loginAction:function(){return function(e){localStorage.setItem(d.IS_LOGGED_IN,"true"),e({type:"login",isLoggedIn:h()})}}})(te),ae=function(){return i.a.createElement(y.b,{path:"/login",component:ne})},ie=[g],re=function(){return i.a.createElement(y.c,{history:b},i.a.createElement(z,null),i.a.createElement(f.a,{guards:ie,loading:"Loading..."},i.a.createElement(y.d,null,$(),ee(),J(),ae())))},oe=n(16),ce=n(30),le=n(17),se={isLoggedIn:h()},ue=n(31),me={isWin:!1,gameLevel:{level:"Normal",emptySlotQuantity:2,arraySize:3},winningInfo:[]},pe=function(e){switch(e){case"Easy":return{level:e,emptySlotQuantity:3,arraySize:3};case"Normal":return{level:e,emptySlotQuantity:2,arraySize:3};case"Hard":return{level:e,emptySlotQuantity:1,arraySize:3};default:return{level:2,emptySlotQuantity:2,arraySize:3}}},de=Object(oe.c)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"login":case"logout":return Object(le.a)({},e,{isLoggedIn:t.isLoggedIn});default:return e}},puzzle:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"broadcastWinning":return Object(le.a)({},e,{isWin:t.isWin});case"changeGameLevel":return Object(le.a)({},e,{gameLevel:pe(t.level)});case"getWinningInfo":return console.log(e.winningInfo),console.log(t.winningInfo),Object(le.a)({},e,{winningInfo:[].concat(Object(ue.a)(e.winningInfo),[t.winningInfo])});default:return e}}}),he=[ce.a],ge=Object(oe.e)(de,{},Object(oe.d)(oe.a.apply(void 0,he),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())),fe=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"component-wrapper"},i.a.createElement(p.a,{store:ge},i.a.createElement(re,null)))}}]),t}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(fe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[32,1,2]]]);
//# sourceMappingURL=main.88fb04f6.chunk.js.map